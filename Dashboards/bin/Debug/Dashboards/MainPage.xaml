<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:eng="clr-namespace:DashboardEngine;assembly=DashboardEngine"
      xmlns:dconv="clr-namespace:DashboardEngine.Converters;assembly=DashboardEngine"
      x:Name="Window"
      Title="Main Page">

  <Page.Resources>
    <dconv:XmlElementToString x:Key="xmlElement2StringConverter" />
    
    <Style TargetType="Button">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border x:Name="border" BorderBrush="White" BorderThickness="1" Cursor="Hand">
              <ContentPresenter />
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style TargetType="ListBox">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ListBox">
            <Border BorderBrush="Gray" 
                    BorderThickness="1" 
                    CornerRadius="6">

              <ScrollViewer VerticalScrollBarVisibility="Disabled"
                            HorizontalScrollBarVisibility="Auto">

                <StackPanel IsItemsHost="True"
                            Orientation="Horizontal"
                            HorizontalAlignment="Left" 
                            Margin="15,0,15,0"/>
              </ScrollViewer>

            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style TargetType="ListBoxItem">
      <Setter Property="MaxHeight" Value="100" />
      <Setter Property="MinHeight" Value="100" />
      <Setter Property="MinWidth" Value="115"  />
      <Setter Property="MaxWidth" Value="115"  />

      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ListBoxItem">
            <Border x:Name="border" BorderBrush="Black" BorderThickness="1" Margin="3">
              <Button Command="eng:NavigationCommands.NavigateUri" CommandParameter="{Binding XPath=ScenarioPath, Converter={StaticResource xmlElement2StringConverter}}" CommandTarget="{Binding ElementName=frame}">
                <Grid>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                  </Grid.RowDefinitions>

                  <Image Grid.Row="0" Source="{Binding XPath=ImagePath}" Margin="2" />
                  <Label Grid.Row="1" Content="{Binding XPath=Name}" HorizontalContentAlignment="Center" Foreground="White"/>
                </Grid>
              </Button>

              <Border.RenderTransform>
                <ScaleTransform CenterX="50" CenterY="50" ScaleX="1" ScaleY="1"/>
              </Border.RenderTransform>

              <Border.Triggers>
                <EventTrigger RoutedEvent="Mouse.MouseEnter">
                  <EventTrigger.Actions>
                    <BeginStoryboard>
                      <Storyboard>
                        <DoubleAnimation Duration="0:0:0.1" 
                                         Storyboard.TargetName="border"
                                         Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" 
                                         To="1.1" />

                        <DoubleAnimation Duration="0:0:0.1" 
                                         Storyboard.TargetName="border"
                                         Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" 
                                         To="1.1" />
                      </Storyboard>
                    </BeginStoryboard>
                  </EventTrigger.Actions>
                </EventTrigger>

                <EventTrigger RoutedEvent="Mouse.MouseLeave">
                  <EventTrigger.Actions>
                    <BeginStoryboard>
                      <Storyboard>
                        <DoubleAnimation Duration="0:0:0.3" 
                                         Storyboard.TargetName="border"
                                         Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" />

                        <DoubleAnimation Duration="0:0:0.3" 
                                         Storyboard.TargetName="border"
                                         Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" />
                      </Storyboard>
                    </BeginStoryboard>
                  </EventTrigger.Actions>
                </EventTrigger>
              </Border.Triggers>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <XmlDataProvider x:Key="directions">
      <x:XData>
        <Directions xmlns="">
          <Direction>
            <Name>Quality Assurance</Name>
            <ImagePath>pack://siteoforigin:,,,/Dashboards/Resources/Pictures/dqm.jpg</ImagePath>
            <ScenarioPath>/Scenarios/QA/MainScenario.xml</ScenarioPath>
          </Direction>
          <Direction>
            <Name>IT Дирекция</Name>
            <ImagePath>pack://siteoforigin:,,,/Dashboards/Resources/Pictures/it.jpg</ImagePath>
            <ScenarioPath>/Scenarios/IT/MainScenario.xml</ScenarioPath>
          </Direction>
          <Direction>
            <Name>TD Дирекция</Name>
            <ImagePath>pack://siteoforigin:,,,/Dashboards/Resources/Pictures/td.jpg</ImagePath>
            <ScenarioPath>/Scenarios/TD/MainScenario.xml</ScenarioPath>
          </Direction>
          <Direction>
            <Name>Call Centre</Name>
            <ImagePath>pack://siteoforigin:,,,/Dashboards/Resources/Pictures/cc.jpg</ImagePath>
            <ScenarioPath>/Scenarios/CC/MainScenario.xml</ScenarioPath>
          </Direction>
        </Directions>
      </x:XData>
    </XmlDataProvider>
  </Page.Resources>

  <Grid x:Name="MainLayoutRoot">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <ListBox Grid.Row="0" ItemsSource="{Binding Source={StaticResource directions}, XPath=/Directions/Direction}" Height="120" />
    <Frame x:Name="frame" Grid.Row="1" />
  </Grid>
</Page>